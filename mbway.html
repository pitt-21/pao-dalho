<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pão d'Alho MB WAY</title>
  <style>
    body { font-family: sans-serif; margin: 2em; max-width: 600px; }
    h1 { color: #0b73ff; }
    .mono { background: #f0f0f0; padding: 3px 6px; border-radius: 4px; }
    .item {
      border: 1px solid #ddd; border-radius: 8px;
      padding: 10px 12px; margin: 8px 0;
      display: flex; justify-content: space-between; align-items: center;
    }
    .item-name { font-weight: 600; }
    select { padding: 4px; font-size: 1em; border-radius: 4px; }
    #total { font-size: 1.4em; font-weight: bold; margin-top: 12px; }
    button {
      margin-top: 1em; padding: 10px 15px; background: #0b73ff;
      color: white; border: none; border-radius: 8px; cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Pão d'Alho MB WAY</h1>
  <p>Destinatário: <span id="para" class="mono"></span></p>

  <h2>Seleciona os itens</h2>
  <div id="lista"></div>

  <p id="total">Total: 0,00 €</p>

  <button id="copiar">Copiar destinatário</button>
  <p id="msg"></p>

  <script>
    // Lista de produtos
    const produtos = [
      { nome: "Fino", preco: 1.20 },
      { nome: "Café", preco: 0.80 },
      { nome: "Tosta mista", preco: 2.50 },
      { nome: "Sumo natural", preco: 2.00 },
      { nome: "Água", preco: 1.00 }
    ];

    // Lê o número do URL
    const params = new URLSearchParams(window.location.search);
    const numero = params.get("para") || "—";
    document.getElementById("para").textContent = numero;

    const lista = document.getElementById("lista");
    let total = 0;
    const quantidades = {}; // guarda as quantidades selecionadas

    // Cria elementos da lista
    produtos.forEach((p, i) => {
      const div = document.createElement("div");
      div.className = "item";

      const nome = document.createElement("span");
      nome.className = "item-name";
      nome.textContent = p.nome;

      const select = document.createElement("select");
      for (let q = 0; q <= 10; q++) {
        const opt = document.createElement("option");
        opt.value = q;
        opt.textContent = q;
        select.appendChild(opt);
      }

      select.onchange = () => {
        quantidades[p.nome] = Number(select.value);
        calcularTotal();
      };

      const preco = document.createElement("span");
      preco.textContent = p.preco.toFixed(2) + " €";

      const right = document.createElement("div");
      right.appendChild(preco);
      right.appendChild(select);
      right.style.display = "flex";
      right.style.gap = "10px";
      right.style.alignItems = "center";

      div.appendChild(nome);
      div.appendChild(right);
      lista.appendChild(div);

      quantidades[p.nome] = 0;
    });

    function calcularTotal() {
      total = produtos.reduce((acc, p) => acc + p.preco * quantidades[p.nome], 0);
      document.getElementById("total").textContent =
        "Total: " + total.toFixed(2).replace(".", ",") + " €";
    }

    // Botão copiar apenas o número
    document.getElementById("copiar").onclick = async () => {
      try {
        await navigator.clipboard.writeText(numero);
        document.getElementById("msg").textContent = "Número copiado: " + numero;
      } catch {
        document.getElementById("msg").textContent =
          "Não foi possível copiar automaticamente.";
      }
    };
  </script>
</body>
</html>